{% extends 'analysis_plugins/general_information.html' %}

{% block analysis_result_details %}

{% set metadata_list = analysis_result.get('files', []) %}
{% if metadata_list %}
    <tr>
        <th class="table-success" colspan="2">
            Results for Included Files
        </th>
    </tr>
{% endif %}
{% for metadata in metadata_list %}
    <tr>
        <td>{{ metadata['path'] }}</td>
        <td class="p-0">
            <table class="table table-bordered mb-0">
                {% for key, value in metadata.items() | sort %}
                    {% if key not in ('path', 'key') %}
                        {% set tr_class = "" if key not in ('suid_bit', 'sgid_bit') or not value else "table-danger"%}
                        <tr class={{ tr_class }}>
                            <td>{{ key }}</td>
                            <td>
                                {% if 'time' in key %}
                                    {{ value | nice_unix_time | safe }}
                                {% else %}
                                    {{ value | safe }}
                                {% endif %}
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </table>
        </td>
    </tr>
{% endfor %}

{% endblock %}


{% block ajax %}

<div id="file_results"></div>
<script>
    $(document).ready(function() {
        $('#file_results').load('/plugins/file_system_metadata/ajax/{{ firmware.uid }}');
    });
</script>

{% endblock %}
